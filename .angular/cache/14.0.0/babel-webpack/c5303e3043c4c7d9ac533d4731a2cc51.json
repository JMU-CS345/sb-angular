{"ast":null,"code":"import { QueryList } from '@angular/core';\nimport { Base } from '../base';\nimport { Router } from '@angular/router';\nimport { EpicsService } from '../epics.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { callWithSnackBar } from '../util';\nimport { first } from 'rxjs/operators';\nimport { ProjectService } from '../project.service';\nimport { Color } from '../color';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../epics.service\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"../project.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/material/tooltip\";\nimport * as i10 from \"@angular/material/progress-spinner\";\nimport * as i11 from \"../epic-detail/epic-detail.component\";\nimport * as i12 from \"../epic-list/epic-list.component\";\nimport * as i13 from \"../project-frame/project-frame.component\";\nimport * as i14 from \"../epic-form/epic-form.component\";\nconst _c0 = [\"createEpic\"];\n\nfunction EpicsViewInnerComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_11_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r12.clearDetail());\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\", 20);\n    i0.ɵɵtext(3, \"arrow_back\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(4, \" Epic List \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\");\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"mat-icon\", 22);\n    i0.ɵɵtext(2, \"edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" Edit Epic \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"mat-icon\", 22);\n    i0.ɵɵtext(2, \"add_circle\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" Create Epic \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-epic-detail\", 23);\n    i0.ɵɵlistener(\"editEpic\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_div_1_Template_app_epic_detail_editEpic_1_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r15.mode = \"edit\");\n    })(\"reorder\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_div_1_Template_app_epic_detail_reorder_1_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r17.onReorderIssues($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"epic\", ctx_r14.epic)(\"showEditButton\", ctx_r14.permission(ctx_r14.epic, \"update\"));\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_div_1_Template, 2, 2, \"div\", 15);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"show\");\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_sb_epic_form_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"sb-epic-form\", 25);\n    i0.ɵɵlistener(\"confirmEdit\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_sb_epic_form_1_Template_sb_epic_form_confirmEdit_0_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r19.confirmEdit($event));\n    })(\"cancelEdit\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_sb_epic_form_1_Template_sb_epic_form_cancelEdit_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r21 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r21.cancelEdit());\n    })(\"deleteEpic\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_sb_epic_form_1_Template_sb_epic_form_deleteEpic_0_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r22 = i0.ɵɵnextContext(4);\n      return i0.ɵɵresetView(ctx_r22.delete($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r18 = i0.ɵɵnextContext(4);\n    i0.ɵɵproperty(\"epic\", ctx_r18.epic);\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_sb_epic_form_1_Template, 1, 1, \"sb-epic-form\", 24);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"edit\");\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"sb-epic-form\", 26, 27);\n    i0.ɵɵlistener(\"confirmEdit\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_21_Template_sb_epic_form_confirmEdit_1_listener($event) {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r24 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r24.saveNewEpic($event));\n    })(\"cancelEdit\", function EpicsViewInnerComponent_app_project_frame_2_div_1_div_21_Template_sb_epic_form_cancelEdit_1_listener() {\n      i0.ɵɵrestoreView(_r25);\n      const ctx_r26 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r26.cancelEdit());\n    });\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    \"large-only\": a0\n  };\n};\n\nfunction EpicsViewInnerComponent_app_project_frame_2_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 4)(2, \"div\", 5)(3, \"div\", 6)(4, \"div\", 7)(5, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function EpicsViewInnerComponent_app_project_frame_2_div_1_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r27.createEpic());\n    });\n    i0.ɵɵelementStart(6, \"mat-icon\", 9);\n    i0.ɵɵtext(7, \"add_circle\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \" New \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"app-epic-list\", 10, 11);\n    i0.ɵɵlistener(\"selectEpic\", function EpicsViewInnerComponent_app_project_frame_2_div_1_Template_app_epic_list_selectEpic_9_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r29 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r29.showDetail($event));\n    })(\"reorderEpics\", function EpicsViewInnerComponent_app_project_frame_2_div_1_Template_app_epic_list_reorderEpics_9_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r30 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r30.onReorderEpics($event));\n    })(\"transferIssue\", function EpicsViewInnerComponent_app_project_frame_2_div_1_Template_app_epic_list_transferIssue_9_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r31 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r31.onTransferIssue($event));\n    })(\"updateEpic\", function EpicsViewInnerComponent_app_project_frame_2_div_1_Template_app_epic_list_updateEpic_9_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r32 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r32.onUpdateEpic($event));\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(11, EpicsViewInnerComponent_app_project_frame_2_div_1_div_11_Template, 5, 0, \"div\", 12);\n    i0.ɵɵelementStart(12, \"div\", 13)(13, \"div\", 6)(14, \"mat-card-title\", 14);\n    i0.ɵɵtemplate(15, EpicsViewInnerComponent_app_project_frame_2_div_1_div_15_Template, 1, 0, \"div\", 15);\n    i0.ɵɵtemplate(16, EpicsViewInnerComponent_app_project_frame_2_div_1_div_16_Template, 4, 0, \"div\", 16);\n    i0.ɵɵtemplate(17, EpicsViewInnerComponent_app_project_frame_2_div_1_div_17_Template, 4, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"mat-card-content\", 14);\n    i0.ɵɵtemplate(19, EpicsViewInnerComponent_app_project_frame_2_div_1_div_19_Template, 2, 1, \"div\", 17);\n    i0.ɵɵtemplate(20, EpicsViewInnerComponent_app_project_frame_2_div_1_div_20_Template, 2, 1, \"div\", 15);\n    i0.ɵɵtemplate(21, EpicsViewInnerComponent_app_project_frame_2_div_1_div_21_Template, 3, 0, \"div\", 15);\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(14, _c1, ctx_r3.epic || ctx_r3.mode == \"edit\" || ctx_r3.mode == \"create\"));\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"epics\", ctx_r3.epics)(\"project\", ctx_r3.project)(\"fixed\", !ctx_r3.permission(ctx_r3.project, \"update\"))(\"allowCreateIssue\", ctx_r3.permission(ctx_r3.project, \"create-issue\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.epic);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngSwitch\", ctx_r3.mode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"show\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"edit\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"create\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitch\", ctx_r3.mode);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.epic);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"edit\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngSwitchCase\", \"create\");\n  }\n}\n\nfunction EpicsViewInnerComponent_app_project_frame_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-project-frame\", 2);\n    i0.ɵɵtemplate(1, EpicsViewInnerComponent_app_project_frame_2_div_1_Template, 22, 16, \"div\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n\n    const _r0 = i0.ɵɵreference(1);\n\n    i0.ɵɵproperty(\"project\", ctx_r2.project);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.epics)(\"ngIfElse\", _r0);\n  }\n}\n\nexport let EpicsViewInnerComponent = /*#__PURE__*/(() => {\n  class EpicsViewInnerComponent extends Base {\n    constructor(router, epicsService, snackBar, projectService) {\n      super();\n      this.router = router;\n      this.epicsService = epicsService;\n      this.snackBar = snackBar;\n      this.projectService = projectService;\n      this.mode = \"show\";\n    }\n\n    ngOnInit() {}\n\n    set epic(value) {\n      this._epic = value;\n      this.mode = 'show';\n    }\n\n    get epic() {\n      return this._epic;\n    }\n\n    editEpic() {\n      this.mode = 'edit';\n    }\n\n    showDetail(epic) {\n      if (this.mode == 'show') {\n        this.router.navigate(['projects', this.project.id, 'epics', epic.id]);\n      }\n    }\n\n    cancelEdit() {\n      this.mode = 'show';\n    }\n\n    confirmEdit(epic) {\n      this.mode = 'show';\n      callWithSnackBar(this.snackBar, this.epicsService.save(epic), ['Saving epic...', 'Epic saved', 'Error saving epic']);\n    }\n\n    createEpic() {\n      this.mode = \"create\"; // need to wait for the epic form to be added to the view.\n\n      this.createEpicComponent.changes.pipe(first()).subscribe(x => {\n        this.createEpicComponent.first.epic = {\n          id: -1,\n          title: '',\n          description: '',\n          size: 0,\n          color: '#FFFFFF',\n          project: this.project\n        };\n      });\n    }\n\n    saveNewEpic(epic) {\n      callWithSnackBar(this.snackBar, this.epicsService.createEpic(epic), ['Creating epic...', 'Epic created', 'Error creating epic']).subscribe(success => {\n        this.mode = \"show\";\n        this.router.navigate(['projects', this.project.id, 'epics', success.id]);\n      });\n    }\n\n    onReorderEpics(reorderData) {\n      callWithSnackBar(this.snackBar, this.projectService.reorderEpics(this.project, reorderData.fromIndex, reorderData.toIndex), [\"Reordering Epics...\", \"Epics Reordered\", \"Error Reordering Epics\"]);\n    }\n\n    onReorderIssues(reorderData) {\n      callWithSnackBar(this.snackBar, this.epicsService.reorderIssues(this.epic, reorderData.fromIndex, reorderData.toIndex), [\"Reordering Issues...\", \"Issues Reordered\", \"Error Reordering Issues\"]);\n    }\n\n    delete(epic) {\n      callWithSnackBar(this.snackBar, this.epicsService.deleteEpic(epic.id), [\"Deleting epic...\", \"Epic deleted\", \"Error deleting epic\"]).subscribe(success => {\n        this.mode = \"show\";\n        this.router.navigate(['projects', this.project.id, 'epics']);\n      });\n    }\n\n    fontColor(bgColor) {\n      return Color.fontColor(bgColor);\n    }\n\n    clearDetail() {\n      this.router.navigate(['projects', this.project.id, 'epics']);\n    }\n\n  }\n\n  EpicsViewInnerComponent.ɵfac = function EpicsViewInnerComponent_Factory(t) {\n    return new (t || EpicsViewInnerComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.EpicsService), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(i4.ProjectService));\n  };\n\n  EpicsViewInnerComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EpicsViewInnerComponent,\n    selectors: [[\"sb-epics-view-inner\"]],\n    viewQuery: function EpicsViewInnerComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.createEpicComponent = _t);\n      }\n    },\n    inputs: {\n      project: \"project\",\n      epics: \"epics\",\n      epic: \"epic\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 3,\n    vars: 2,\n    consts: [[\"progressSpinner\", \"\"], [3, \"project\", 4, \"ngIf\", \"ngIfElse\"], [3, \"project\"], [4, \"ngIf\", \"ngIfElse\"], [1, \"row\"], [1, \"col-md-6\", 3, \"ngClass\"], [1, \"inner-detail-card\"], [1, \"col-12\", \"text-right\", \"p-0\"], [\"mat-button\", \"\", \"matTooltip\", \"New Epic\", 1, \"add-button\", \"icon-button\", 3, \"click\"], [1, \"mr-1\"], [1, \"epic-list\", 3, \"epics\", \"project\", \"fixed\", \"allowCreateIssue\", \"selectEpic\", \"reorderEpics\", \"transferIssue\", \"updateEpic\"], [\"epicList\", \"\"], [\"class\", \"epic-div arrow-div col-12 small-only\", 4, \"ngIf\"], [1, \"col-md-6\", \"col-sm-12\"], [3, \"ngSwitch\"], [4, \"ngSwitchCase\"], [\"class\", \"banner-text pt-4\", 4, \"ngSwitchCase\"], [4, \"ngIf\"], [1, \"epic-div\", \"arrow-div\", \"col-12\", \"small-only\"], [\"mat-icon-button\", \"\", 1, \"arrow-button\", 3, \"click\"], [1, \"align-middle\"], [1, \"banner-text\", \"pt-4\"], [1, \"mr-1\", \"sb-icon\"], [3, \"epic\", \"showEditButton\", \"editEpic\", \"reorder\"], [\"mode\", \"edit\", 3, \"epic\", \"confirmEdit\", \"cancelEdit\", \"deleteEpic\", 4, \"ngSwitchCase\"], [\"mode\", \"edit\", 3, \"epic\", \"confirmEdit\", \"cancelEdit\", \"deleteEpic\"], [\"mode\", \"create\", 3, \"confirmEdit\", \"cancelEdit\"], [\"createEpic\", \"\"]],\n    template: function EpicsViewInnerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, EpicsViewInnerComponent_ng_template_0_Template, 1, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(2, EpicsViewInnerComponent_app_project_frame_2_Template, 2, 3, \"app-project-frame\", 1);\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(1);\n\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.project)(\"ngIfElse\", _r0);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgIf, i5.NgSwitch, i5.NgSwitchCase, i6.MatCardContent, i6.MatCardTitle, i7.MatIcon, i8.MatButton, i9.MatTooltip, i10.MatSpinner, i11.EpicDetailComponent, i12.EpicListComponent, i13.ProjectFrameComponent, i14.EpicFormComponent],\n    styles: [\".inner-detail-card[_ngcontent-%COMP%]{font-family:var(--banner-font);background-color:var(--background);color:var(--on-background)}.epic-list[_ngcontent-%COMP%]{font-family:var(--banner-font)}@media screen and (min-width: 800px){.inner-view-small[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 799px){.inner-view-large[_ngcontent-%COMP%]{display:none}}.epic-div[_ngcontent-%COMP%]{margin:0 auto;border:1px solid var(--card-border);padding-left:4px;padding-top:2px;padding-bottom:2px;vertical-align:middle}.unselected[_ngcontent-%COMP%]{display:none}.arrow-button[_ngcontent-%COMP%]{padding:0}\"]\n  });\n  return EpicsViewInnerComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}