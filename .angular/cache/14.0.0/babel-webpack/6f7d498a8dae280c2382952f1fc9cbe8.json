{"ast":null,"code":"import { Base } from '../base';\nimport { IssuesService } from '../issues.service';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { callWithSnackBar } from '../util';\nimport { DataService } from '../data.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../issues.service\";\nimport * as i2 from \"@angular/material/snack-bar\";\nimport * as i3 from \"../data.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/card\";\nimport * as i6 from \"@angular/material/progress-spinner\";\nimport * as i7 from \"../issue-detail/issue-detail.component\";\nimport * as i8 from \"../project-frame/project-frame.component\";\nimport * as i9 from \"../sprint-list/sprint-list.component\";\nimport * as i10 from \"../issue-loader/issue-loader.component\";\nimport * as i11 from \"../sprint-retrospective-report/sprint-retrospective-report.component\";\n\nfunction SprintRetrospectiveComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nfunction SprintRetrospectiveComponent_app_project_frame_2_div_8_sb_sprint_retrospective_report_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"sb-sprint-retrospective-report\", 13);\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"sprintId\", ctx_r5.selectedSprint.id);\n  }\n}\n\nfunction SprintRetrospectiveComponent_app_project_frame_2_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtemplate(1, SprintRetrospectiveComponent_app_project_frame_2_div_8_sb_sprint_retrospective_report_1_Template, 1, 1, \"sb-sprint-retrospective-report\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.selectedSprint);\n  }\n}\n\nfunction SprintRetrospectiveComponent_app_project_frame_2_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"sb-issue-loader\", 15)(2, \"app-issue-detail\", 16, 17);\n    i0.ɵɵlistener(\"completeIssue\", function SprintRetrospectiveComponent_app_project_frame_2_div_9_Template_app_issue_detail_completeIssue_2_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.onCompleteIssue($event));\n    });\n    i0.ɵɵpipe(4, \"async\");\n    i0.ɵɵpipe(5, \"async\");\n    i0.ɵɵpipe(6, \"async\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"issueId\", ctx_r4.selectedIssueId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"showAcceptanceCriteria\", ctx_r4.project.setting_use_acceptance_criteria)(\"showCompletionCheckboxes\", true)(\"editable\", false)(\"epics\", i0.ɵɵpipeBind1(4, 6, ctx_r4.epics$).epics == null ? null : i0.ɵɵpipeBind1(4, 6, ctx_r4.epics$).epics.list)(\"sprints\", i0.ɵɵpipeBind1(5, 8, ctx_r4.sprints$).sprints == null ? null : i0.ɵɵpipeBind1(5, 8, ctx_r4.sprints$).sprints.list.concat(i0.ɵɵpipeBind1(6, 10, ctx_r4.oldSprints$).sprints == null ? null : i0.ɵɵpipeBind1(6, 10, ctx_r4.oldSprints$).sprints.list));\n  }\n}\n\nfunction SprintRetrospectiveComponent_app_project_frame_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-project-frame\", 2)(1, \"div\", 3)(2, \"div\", 4)(3, \"mat-card\", 5)(4, \"div\", 6)(5, \"div\", 7);\n    i0.ɵɵtext(6, \"Completed Sprints\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"sb-sprint-list\", 8);\n    i0.ɵɵlistener(\"selected\", function SprintRetrospectiveComponent_app_project_frame_2_Template_sb_sprint_list_selected_7_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.selectSprint($event));\n    })(\"loaded\", function SprintRetrospectiveComponent_app_project_frame_2_Template_sb_sprint_list_loaded_7_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.selectSprint($event));\n    })(\"issueSelected\", function SprintRetrospectiveComponent_app_project_frame_2_Template_sb_sprint_list_issueSelected_7_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.onIssueSelected($event));\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(8, SprintRetrospectiveComponent_app_project_frame_2_div_8_Template, 2, 1, \"div\", 9);\n    i0.ɵɵtemplate(9, SprintRetrospectiveComponent_app_project_frame_2_div_9_Template, 7, 12, \"div\", 10);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"project\", ctx_r2.project);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"project\", ctx_r2.project)(\"completedOnly\", true)(\"showStartButton\", false)(\"editable\", false);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r2.selectedIssueId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selectedIssueId);\n  }\n}\n\nexport let SprintRetrospectiveComponent = /*#__PURE__*/(() => {\n  class SprintRetrospectiveComponent extends Base {\n    constructor(issuesService, snackBar, dataService) {\n      super();\n      this.issuesService = issuesService;\n      this.snackBar = snackBar;\n      this.dataService = dataService;\n      this.editingRetrospective = false;\n      this.selectedIssueId = null;\n    }\n\n    ngOnInit() {}\n\n    loadEpics() {\n      if (!this.project) {\n        return;\n      }\n\n      this.dataService.load(`projects/${this.project.id}/epics`, [`projects/${this.project.id}/epics`, `projects/${this.project.id}/epics/*`]);\n      this.epics$ = this.dataService.values[`projects/${this.project.id}/epics`];\n      this.dataService.load(`projects/${this.project.id}/sprints?current=true`, [`projects/${this.project.id}/sprints`, `projects/${this.project.id}/sprints/*`]);\n      this.sprints$ = this.dataService.values[`projects/${this.project.id}/sprints?current=true`];\n      this.dataService.load(`projects/${this.project.id}/sprints?current=false`, [`projects/${this.project.id}/sprints`, `projects/${this.project.id}/sprints/*`]);\n      this.oldSprints$ = this.dataService.values[`projects/${this.project.id}/sprints?current=false`];\n    }\n\n    unloadEpics(p) {\n      if (!p) {\n        return;\n      }\n\n      this.dataService.unload(`projects/${p.id}/epics`, [`projects/${p.id}/epics`, `projects/${p.id}/epics/*`]);\n    }\n\n    set project(value) {\n      console.log(\"stop here 2\");\n\n      if (this._project) {\n        this.unloadEpics(this._project);\n      }\n\n      this._project = value;\n\n      if (this._project) {\n        this.loadEpics();\n      }\n    }\n\n    get project() {\n      return this._project;\n    }\n\n    selectSprint(sprint) {\n      console.log(\"select sprint\");\n      this.selectedIssueId = null;\n      this.selectedSprint = sprint;\n    }\n\n    printSprintReport(sprint) {}\n\n    onIssueSelected(issue) {\n      this.selectedIssueId = issue.id;\n    }\n\n    onCompleteIssue(issue) {\n      callWithSnackBar(this.snackBar, this.issuesService.markCompleted(issue.id), [\"Completing issue...\", \"Issue completed\", \"Error completing issue\"]);\n    }\n\n  }\n\n  SprintRetrospectiveComponent.ɵfac = function SprintRetrospectiveComponent_Factory(t) {\n    return new (t || SprintRetrospectiveComponent)(i0.ɵɵdirectiveInject(i1.IssuesService), i0.ɵɵdirectiveInject(i2.MatSnackBar), i0.ɵɵdirectiveInject(i3.DataService));\n  };\n\n  SprintRetrospectiveComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SprintRetrospectiveComponent,\n    selectors: [[\"app-sprint-retrospective\"]],\n    inputs: {\n      project: \"project\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 3,\n    vars: 2,\n    consts: [[\"progressSpinner\", \"\"], [3, \"project\", 4, \"ngIf\", \"ngIfElse\"], [3, \"project\"], [1, \"row\"], [1, \"col-md-6\", \"no-print\"], [1, \"inner-detail-card\"], [2, \"height\", \"100%\"], [1, \"banner-text\"], [3, \"project\", \"completedOnly\", \"showStartButton\", \"editable\", \"selected\", \"loaded\", \"issueSelected\"], [\"class\", \"col-md-6 print-expand\", 4, \"ngIf\"], [\"class\", \"col-md-6\", 4, \"ngIf\"], [1, \"col-md-6\", \"print-expand\"], [3, \"sprintId\", 4, \"ngIf\"], [3, \"sprintId\"], [1, \"col-md-6\"], [3, \"issueId\"], [3, \"showAcceptanceCriteria\", \"showCompletionCheckboxes\", \"editable\", \"epics\", \"sprints\", \"completeIssue\"], [\"issueView\", \"\"]],\n    template: function SprintRetrospectiveComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, SprintRetrospectiveComponent_ng_template_0_Template, 1, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(2, SprintRetrospectiveComponent_app_project_frame_2_Template, 10, 7, \"app-project-frame\", 1);\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(1);\n\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.project)(\"ngIfElse\", _r0);\n      }\n    },\n    dependencies: [i4.NgIf, i5.MatCard, i6.MatSpinner, i7.IssueDetailComponent, i8.ProjectFrameComponent, i9.SprintListComponent, i10.IssueLoaderComponent, i11.SprintRetrospectiveReportComponent, i4.AsyncPipe],\n    styles: [\".inner-detail-card[_ngcontent-%COMP%]{background-color:var(--background);color:var(--on-background);border-radius:1px}\"]\n  });\n  return SprintRetrospectiveComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}