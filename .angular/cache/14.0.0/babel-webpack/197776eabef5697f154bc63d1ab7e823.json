{"ast":null,"code":"import { Component, QueryList } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { DataService } from '../data.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../data.service\";\nconst _c0 = [\"epicView\"];\nconst _c1 = [\"*\"];\nexport let EpicLoaderComponent = /*#__PURE__*/(() => {\n  class EpicLoaderComponent {\n    constructor(dataService) {\n      this.dataService = dataService;\n    }\n\n    ngOnInit() {}\n\n    ngAfterViewInit() {\n      this.updateData(this.epicId);\n    }\n\n    updateData(id) {\n      if (id == 0) {\n        return;\n      }\n\n      this.dataService.load(`epics/${id}`, [`epics/${id}`]);\n      this.sub = this.dataService.values[`epics/${id}`].subscribe(x => {\n        console.log(`loaded epic: ${x}`);\n        if (x == null) return;\n\n        if (this.components) {\n          this.components.toArray().forEach(component => {\n            component[\"epic\"] = x;\n          });\n        }\n      });\n    }\n\n    unloadData(id) {\n      var _a;\n\n      this.dataService.unload(`epics/${id}`, [`epics/${id}`]);\n      (_a = this.sub) === null || _a === void 0 ? void 0 : _a.unsubscribe();\n    }\n\n    set epicId(value) {\n      if (this._epicId) {\n        this.unloadData(this._epicId);\n      }\n\n      this._epicId = value;\n\n      if (this._epicId) {\n        this.updateData(this._epicId);\n      }\n    }\n\n    get epicId() {\n      return this._epicId;\n    }\n\n    ngOnDestroy() {\n      this.unloadData(this._epicId);\n    }\n\n  }\n\n  EpicLoaderComponent.ɵfac = function EpicLoaderComponent_Factory(t) {\n    return new (t || EpicLoaderComponent)(i0.ɵɵdirectiveInject(i1.DataService));\n  };\n\n  EpicLoaderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EpicLoaderComponent,\n    selectors: [[\"sb-epic-loader\"]],\n    contentQueries: function EpicLoaderComponent_ContentQueries(rf, ctx, dirIndex) {\n      if (rf & 1) {\n        i0.ɵɵcontentQuery(dirIndex, _c0, 4);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.components = _t);\n      }\n    },\n    inputs: {\n      epicId: \"epicId\"\n    },\n    ngContentSelectors: _c1,\n    decls: 1,\n    vars: 0,\n    template: function EpicLoaderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵprojectionDef();\n        i0.ɵɵprojection(0);\n      }\n    }\n  });\n  return EpicLoaderComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}